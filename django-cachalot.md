üöÄ –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
–ï—Å–ª–∏ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å django-cachalot, —Ç–æ –Ω–µ —Å—Ç–æ–∏—Ç –≤—Ä—É—á–Ω—É—é –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å ORM-–∑–∞–ø—Ä–æ—Å—ã, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

–ù–æ –µ—Å–ª–∏ —É —Ç–µ–±—è –µ—Å—Ç—å —Å–ª–æ–∂–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è, API-–∑–∞–ø—Ä–æ—Å—ã, –≤–Ω–µ—à–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ ‚Äî —Ç–æ–≥–¥–∞ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –≤—Ä—É—á–Ω—É—é.

üëâ –¢–æ –µ—Å—Ç—å django-cachalot —Ö–æ—Ä–æ—à –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è ORM, –∞ Redis ‚Äî –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ–≥–æ –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ. üòé

Django-Cachalot ‚Äî —ç—Ç–æ –∫–µ—à–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î. –û–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã 
–∑–∞–ø—Ä–æ—Å–æ–≤ ORM –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç, —á—Ç–æ–±—ã —Å–Ω–∏–∑–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –ù–æ –≤ –æ—Ç–ª–∏—á–∏–µ 
–æ—Ç redis, –æ–Ω –Ω–µ –∫–µ—à–∏—Ä—É–µ—Ç –≤—Ä—É—á–Ω—É—é –∑–∞–¥–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Äî —Ç–æ–ª—å–∫–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã ORM-–∑–∞–ø—Ä–æ—Å–æ–≤.

–û–Ω —Å–ª–µ–¥–∏—Ç –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –≤ –ë–î

–ï—Å–ª–∏ —Ç—ã –¥–æ–±–∞–≤–ª—è–µ—à—å/–∏–∑–º–µ–Ω—è–µ—à—å/—É–¥–∞–ª—è–µ—à—å –æ–±—ä–µ–∫—Ç—ã —á–µ—Ä–µ–∑ Model.objects.create(), .update(), .delete(),
‚Üí cachalot –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç (—É–¥–∞–ª—è–µ—Ç) —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∑–∞–ø–∏—Å–∏ –∏–∑ –∫–µ—à–∞.
–ù–æ –µ—Å–ª–∏ —Ç—ã –¥–µ–ª–∞–µ—à—å —á–∏—Å—Ç—ã–π SQL-–∑–∞–ø—Ä–æ—Å (raw SQL), cachalot –º–æ–∂–µ—Ç –Ω–µ –∑–∞–º–µ—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è.

–ü–æ—á–µ–º—É –æ–Ω —Ç–∞–∫ –±—ã—Å—Ç—Ä?
cachalot –∫–µ—à–∏—Ä—É–µ—Ç —Å—Ä–∞–∑—É —Ü–µ–ª—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã, –∞ –Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏.
–û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
‚Üí –∫–æ–≥–¥–∞ —Ç—ã –¥–µ–ª–∞–µ—à—å MyModel.objects.filter(...), –æ–Ω —Ö–µ—à–∏—Ä—É–µ—Ç —Å–∞–º –∑–∞–ø—Ä–æ—Å –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å—Ç—å –ª–∏ –µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –∫–µ—à–µ.
cachalot –∏–∑–±–µ–≥–∞–µ—Ç –ª–∏—à–Ω–∏—Ö –ø–æ—Ö–æ–¥–æ–≤ –≤ –±–∞–∑—É
–í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ª–µ–∑—Ç—å –≤ PostgreSQL, –æ–Ω –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–µ—à.

üìå –ö–∞–∫ –µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å? (–Ω–æ –º–æ–∂–Ω–æ –∏ –Ω–µ —Ç—Ä–æ–≥–∞—Ç—å)
–û–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –¥–æ–ø. –Ω–∞—Å—Ç—Ä–æ–µ–∫, –Ω–æ –º–æ–∂–Ω–æ —Ç–æ–Ω–∫–æ –µ–≥–æ –ø–æ–¥–∫—Ä—É—Ç–∏—Ç—å
CACHALOT_TIMEOUT = 3600  # –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫–µ—à–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ)
CACHALOT_ENABLED = True  # –ú–æ–∂–Ω–æ –≤—ã–∫–ª—é—á–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
CACHALOT_ONLY_CACHABLE_TABLES = ('my_big_table',)  # –ö–µ—à–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —ç—Ç–∏ —Ç–∞–±–ª–∏—Ü—ã
CACHALOT_UNCACHABLE_TABLES = ('my_log_table',)  # –ù–µ –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–∏ —Ç–∞–±–ª–∏—Ü—ã

üìå –ö–æ–≥–¥–∞ –ù–ï —Å—Ç–æ–∏—Ç –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?
–ï—Å–ª–∏ —É —Ç–µ–±—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –º–µ–Ω—è—é—â–∏–µ—Å—è –¥–∞–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–µ–Ω—Ç–∞ –Ω–æ–≤–æ—Å—Ç–µ–π).
–ï—Å–ª–∏ —É —Ç–µ–±—è –∫—É—á–∞ UPDATE-–∑–∞–ø—Ä–æ—Å–æ–≤ ‚Äî —Ç–æ–≥–¥–∞ –∫–µ—à –±—É–¥–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å—Å—è, –∏ —Å–º—ã—Å–ª–∞ –≤ –Ω—ë–º –º–∞–ª–æ.
–ï—Å–ª–∏ —Ç—ã –¥–µ–ª–∞–µ—à—å —Å–ª–æ–∂–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∏ —Å—Ç—Ä–æ–∏—à—å –æ—Ç—á—ë—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–≤–µ–∂–∏—Ö –¥–∞–Ω–Ω—ã—Ö.
–ù–æ –µ—Å–ª–∏ —É —Ç–µ–±—è —á–∏—Ç–∞–µ–º–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –±–æ–ª—å—à–µ, —á–µ–º –∑–∞–ø–∏—Å—å, django-cachalot –¥–∞—ë—Ç –æ–≥—Ä–æ–º–Ω—ã–π –±—É—Å—Ç –∫ —Å–∫–æ—Ä–æ—Å—Ç–∏. üöÄ



—É django-cachalot –µ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –∫–µ—à–∞ ‚Äî –Ω–µ –±–æ–ª–µ–µ 50 —Ä–∞–∑ –≤ –º–∏–Ω—É—Ç—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

‚ùì –ü–æ—á–µ–º—É –µ—Å—Ç—å –ª–∏–º–∏—Ç?
–≠—Ç–æ—Ç –ª–∏–º–∏—Ç —Å–¥–µ–ª–∞–Ω, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ –∫–µ—à–∞. –ï—Å–ª–∏ —É —Ç–µ–±—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç 1000 —Ä–∞–∑ –≤ –º–∏–Ω—É—Ç—É, —Ç–æ –∫–µ—à –ø—Ä–æ—Å—Ç–æ –±—É–¥–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å—Å—è, –∏ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–µ—Ä—è–µ—Ç —Å–º—ã—Å–ª.

üîß –ì–¥–µ —ç—Ç–æ—Ç –ª–∏–º–∏—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è?
–¢—ã –º–æ–∂–µ—à—å –µ–≥–æ –∏–∑–º–µ–Ω–∏—Ç—å —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä CACHALOT_CACHE_RANDOM –≤ settings.py

CACHALOT_CACHE_RANDOM = 0  # –û—Ç–∫–ª—é—á–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
CACHALOT_CACHE_RANDOM = 0.1  # –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å–ª—É—á–∞–π–Ω–æ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å —á–∞—Å—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –∫–µ—à–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.1)
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å—Ç–æ–∏—Ç 0.1, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∫–µ—à –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–º–µ—Ä–Ω–æ 90% —Ä–∞–∑, –∞ 10% –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ä–µ—Å—É—Ä—Å–æ–≤.

üöÄ –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ —É —Ç–µ–±—è –º–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤ –º–∏–Ω—É—Ç—É?
–ï—Å–ª–∏ —É —Ç–µ–±—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —á–∞—Å—Ç–æ –º–µ–Ω—è—é—â–∏–µ—Å—è –¥–∞–Ω–Ω—ã–µ, —Ç–æ

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–µ—à –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–æ–¥–µ–ª–∏ –≤–º–µ—Å—Ç–æ cachalot (–Ω–∞–ø—Ä–∏–º–µ—Ä, django-cacheops).
–ö–µ—à–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ—Å–æ–±–æ —Ç—è–∂—ë–ª—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –∞ –Ω–µ –≤–µ—Å—å ORM.
–ù–∞—Å—Ç—Ä–æ–∏—Ç—å CACHALOT_UNCACHABLE_TABLES, —á—Ç–æ–±—ã –Ω–µ –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å —á–∞—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è–µ–º—ã–µ —Ç–∞–±–ª–∏—Ü—ã.
–ú–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —É–≤–µ–ª–∏—á–∏—Ç—å –ª–∏–º–∏—Ç, –Ω–æ —ç—Ç–æ –º–æ–∂–µ—Ç —É—Ö—É–¥—à–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.
üëâ –¢–∞–∫ —á—Ç–æ –µ—Å–ª–∏ —É —Ç–µ–±—è —Ä–µ–¥–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, —Ç–æ cachalot ‚Äì —Ç–æ–ø—á–∏–∫. –ï—Å–ª–∏ —É —Ç–µ–±—è —á–∞—Å—Ç—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–ª–∏ –º–µ—Ç—Ä–∏–∫–∏), —Ç–æ –ª—É—á—à–µ –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å –ø–æ-–¥—Ä—É–≥–æ–º—É. üòé